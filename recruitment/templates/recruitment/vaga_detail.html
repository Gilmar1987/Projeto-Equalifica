<!-- templates/recruitment/vaga_detail.html -->
{% extends 'base.html' %}
{% block title %}{{ vaga.titulo }}{% endblock %}
{% block content %}
<h1>{{ vaga.titulo }}</h1>
<p><strong>Descrição:</strong> {{ vaga.descricao }}</p>
<p><strong>Requisitos:</strong> {{ vaga.requisitos }}</p>
<p><strong>Empresa:</strong> {{ vaga.cnpj_empresa }}</p>

{% if user.is_authenticated and user.user_type == 'pcd' %}
    {% if not tem_perfil_pcd %}
        <p style="color: orange;">⚠️ Você precisa completar seu perfil PCD antes de se candidatar.</p>
        <p><a href="{% url 'pcd_dashboard' %}">Completar perfil →</a></p>
    {% elif ja_candidatado %}
        <p style="color: green;">✅ Você já se candidatou a esta vaga.</p>
    {% else %}
        <form method="post" action="{% url 'candidatar' vaga.id %}">
            {% csrf_token %}
            <button type="submit">Candidatar-se</button>
        </form>
    {% endif %}
{% elif not user.is_authenticated %}
    <p><a href="{% url 'login' %}">Faça login para se candidatar</a></p>
{% endif %}

<a href="{% url 'vagas_list' %}">← Voltar às vagas</a>
{% endblock %}